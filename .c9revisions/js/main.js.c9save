{"ts":1357078622547,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"// declare a bunch of variable we will need later\nvar container;\nvar representation, controller;\n\n//variables for game loop\nvar timeAtLastFrame = new Date().getTime();\nvar idealTimePerFrame = 1000 / 30;              // 30 fps ideal\nvar leftover = 0.0;\nvar frames = 0;\n\n// ## bootstrap functions\nif ( ! Detector.webgl ){\n\t// test if webgl is supported\n\tDetector.addGetWebGLMessage();\n}else{\n\t// initialiaze everything\n\tinit();\n\t// make it move\t\t\t\n\tanimate();\t\n}\n\n// ## Initialize everything\nfunction init() {\n\t// create the container element\n\tcontainer = document.createElement( 'div' );\n\tcontainer.id = \"3D\";\n\tdocument.body.appendChild( container );\n\n\t// start game\n    var model = new Game.Game();\n    representation = new Game.Representation(model);\n    controller = new Game.Controller(model);            // in this order, because controller needs to listen to representaitons events\n    \n    \n    container.appendChild( representation.getRendererDOM() );\n    // init the Stats and append it to the Dom - performance vuemeter\n\tstats\t= new Stats();\n\tstats.domElement.style.position = 'absolute';\n\tstats.domElement.style.bottom\t= '0px';\n\tcontainer.appendChild( stats.domElement );\n    \n    representation.endLevelAnim();\n}\n\t\t\t\n\n// ## Animate and Display the Scene\nfunction animate() {                                                             /* idea from http://codeofrob.com/entries/a-javascript-game-loop-for-multiplayer-webgl.html */\n    var timeAtThisFrame = new Date().getTime();\n    var timeSinceLastDoLogic = (timeAtThisFrame - timeAtLastFrame) + leftover;\n    var catchUpFrameCount = Math.floor(timeSinceLastDoLogic / idealTimePerFrame);\n\n    controller.handleTicks(catchUpFrameCount);\n    \n\t// render the 3D scene\n\trender();\n\t// relaunch the 'timer' \n\trequestAnimationFrame( animate );\n\t// update the stats\n\tstats.update();\n    \n    // set new dates for next call\n    leftover = timeSinceLastDoLogic - (catchUpFrameCount * idealTimePerFrame);\n    timeAtLastFrame = timeAtThisFrame;\n}\n\n\n// ## Render the 3D Scene\nfunction render() {\n\t// actually display the scene in the Dom element\n\trepresentation.render();\n}\n"]],"start1":0,"start2":0,"length1":0,"length2":2123}]],"length":2123}
{"contributors":[],"silentsave":false,"ts":1357078760199,"patch":[[{"diffs":[[0,"r;\n\n"],[-1,"//variables for game loop\nvar timeAtLastFrame = new Date().getTime();\nvar idealTimePerFrame = 1000 / 30;              // 30 fps ideal\nvar leftover = 0.0;\nvar frames = 0;\n"],[0,"\n// "]],"start1":94,"start2":94,"length1":178,"length2":8},{"diffs":[[0,"    "],[-1,"                                    /* idea from http://codeofrob.com/entries/a-javascript-game-loop-for-multiplayer-webgl.html */\n    var timeAtThisFrame = new Date().getTime();\n    var timeSinceLastDoLogic = (timeAtThisFrame - timeAtLastFrame) + leftover;\n    var catchUpFrameCount = Math.floor(timeSinceLastDoLogic / idealTimePerFrame);\n\n    controller.handleTicks(catchUpFrameCount);\n    \n\t// render the 3D scene\n\trender();\n\t// relaunch the 'timer' \n\trequestAnimationFrame( animate );\n\t// update the stats\n\tstats.update();\n    \n    // set new dates for next call\n    leftover = timeSinceLastDoLogic - (catchUpFrameCount * idealTimePerFrame);\n    timeAtLastFrame = timeAtThisFrame"],[1,"\n\t// render the 3D scene\n\trender();\n\t// relaunch the 'timer' \n\trequestAnimationFrame( animate );\n\t// update the stats\n\tstats.update()"],[0,";\n}\n"]],"start1":1136,"start2":1136,"length1":691,"length2":141}]],"length":1403,"saved":false}
{"ts":1357078783016,"patch":[[{"diffs":[[0,");\n    \n    "],[1,"//"],[0,"representati"]],"start1":1009,"start2":1009,"length1":24,"length2":26},{"diffs":[[0,"Anim();\n"],[1,"    representation.restart();\n"],[0,"}\n\t\t\t\n\n/"]],"start1":1046,"start2":1046,"length1":16,"length2":46}]],"length":1435,"saved":false}
{"ts":1357078851767,"patch":[[{"diffs":[[0,"ion."],[1,"GUI"],[0,"restart("],[1,"true, false"],[0,");\n}"]],"start1":1069,"start2":1069,"length1":16,"length2":30}]],"length":1449,"saved":false}
{"ts":1357079197114,"patch":[[{"diffs":[[0,"ent );\n    \n"],[1,"    // create GUI controls\n    createGUI();\n\n\t// add Mouse events\n\trepresentation.getRendererDOM().domElement.addEventListener( 'mousedown', onDocumentMouseDown, true );\t\t// we only want to activate the user dragging when we click on the canvas and not on the gui/stats\n\tdocument.addEventListener( 'mousemove', onDocumentMouseMove, false );\n\tdocument.addEventListener( 'mouseup', onDocumentMouseUp, false );\n\tdocument.addEventListener( 'mousewheel', onDocumentMouseWheel, false );\n\tdocument.addEventListener( 'DOMMouseScroll', onDocumentMouseWheel, false);\n    \n"],[0,"    //repres"]],"start1":1005,"start2":1005,"length1":24,"length2":586}]],"length":2011,"saved":false}
{"ts":1357079232470,"patch":[[{"diffs":[[0,"erDOM()."],[-1,"domElement."],[0,"addEvent"]],"start1":1108,"start2":1108,"length1":27,"length2":16},{"diffs":[[0,"i/stats\n"],[1,""],[0,"\tdocumen"]],"start1":1268,"start2":1268,"length1":16,"length2":16},{"diffs":[[0,"n.render();\n"],[-1,""],[0,"}\n"],[1,"\n\n/***************************************************\nMouse handling and camera movement taken from \nhttp://mrdoob.github.com/three.js/examples/webgl_panorama_equirectangular.html\n\n\n***************************************************/\n\nfunction onDocumentMouseDown( event ) {\n    event.preventDefault();\n\t\n\tisUserInteracting = true;\n\n\tonPointerDownPointerX = event.clientX;\n\tonPointerDownPointerY = event.clientY;\n\n\tonPointerDownLon = lon;\n\tonPointerDownLat = lat;\n\t\n\t// Shoot ray through the scene [example from http://mrdoob.github.com/three.js/examples/canvas_interactive_cubes.html]\n\tvar vector = new THREE.Vector3( ( event.clientX / window.innerWidth ) * 2 - 1, - ( event.clientY / window.innerHeight ) * 2 + 1, 0.5 );\n\tprojector.unprojectVector( vector, camera );\n\n\tvar ray = new THREE.Ray( camera.position, vector.subSelf( camera.position ).normalize() );\n\n\tvar intersects = ray.intersectObjects( world.gameMeshSphereArr() );\n\n\tif ( intersects.length > 0 ) {\n\t\tworld.clickedOnSphere(intersects[0].object.index);\n\t\t// var particle = new THREE.Particle( particleMaterial );\n\t\t// particle.position = intersects[ 0 ].point;\n\t\t// particle.scale.x = particle.scale.y = 8;\n\t\t// scene.add( particle );\n\n\t}\n}\n\nfunction onDocumentMouseMove( event ) {\n\tif ( isUserInteracting ) {\n\n\t\tlon = ( onPointerDownPointerX - event.clientX ) * 0.1 + onPointerDownLon;\n\t\tlat = ( event.clientY - onPointerDownPointerY ) * 0.1 + onPointerDownLat;\n\t\t//console.log(\"lon = \" + lon + \"    lat = \" + lat);\n\t}\n\t\n}\n\nfunction onDocumentMouseUp( event ) {\n\n\tisUserInteracting = false;\n\n}\n\nfunction onDocumentMouseWheel( event ) {\n\t// WebKit\n\n\tif ( event.wheelDeltaY ) {\n\n\t\tfov -= event.wheelDeltaY * 0.05;\n\n\t// Opera / Explorer 9\n\n\t} else if ( event.wheelDelta ) {\n\n\t\tfov -= event.wheelDelta * 0.05;\n\n\t// Firefox\n\n\t} else if ( event.detail ) {\n\n\t\tfov += event.detail * 1.0;\n\t}\n\n\tcamera.projectionMatrix = THREE.Matrix4.makePerspective( fov, window.innerWidth / window.innerHeight, 1, 10000 );\n\trender();\n}\n\nfunction restartGame(p1S, p2S) {\n\t//console.log(\"RestartGame called with \" + p1S + \" \" + p2S);\n\t// 0 Human, 1 AI easy, 2 AI normal, 3 AI hard\n\tvar p1 = 0, p2 = 0;\n\tif(p1S.indexOf(\"Human\") !== -1){p1 = 0}\n\telse if(p1S.indexOf(\"easy\") !== -1){p1 = 1}\n\telse if(p1S.indexOf(\"normal\") !== -1){p1 = 2}\n\telse if(p1S.indexOf(\"hard\") !== -1){p1 = 3}\n\tif(p2S.indexOf(\"Human\") !== -1){p2 = 0}\n\telse if(p2S.indexOf(\"easy\") !== -1){p2 = 1}\n\telse if(p2S.indexOf(\"normal\") !== -1){p2 = 2}\n\telse if(p2S.indexOf(\"hard\") !== -1){p2 = 3}\n\tworld.reset(p1, p2);\n}\n\n\nfunction createGUI() {\nreturn;\n\tgui = new dat.GUI({\n\theight : 3 * 32 - 1\n\t}); \n\t\n\tvar params = {rotation: 1, player1AI : \"Human\", player2AI : \"AI (normal)\", restart : function(){}}; \n\tgui.add(params, 'rotation').min(1).max(24).step(1).name(\"Rotate Cube\").onChange(function(){\n\t\tworld.rotateGame(params.rotation);\n\t});\n\t\n\tgui.add(params, 'player1AI', [ 'Human', 'AI (easy)', 'AI (normal)', 'AI (hard)' ] ).name(\"Player 1\");\n\tgui.add(params, 'player2AI', [ 'Human', 'AI (easy)', 'AI (normal)', 'AI (hard)' ] ).name(\"Player 2\");\n\t\n\tgui.add(params, 'restart').name(\"Restart\").onFinishChange(function(){\n\t\trestartGame(params.player1AI, params.player2AI)\n\t});\n}\n\n\n\n\n"]],"start1":1986,"start2":1986,"length1":14,"length2":3200}]],"length":5186,"saved":false}
{"ts":1357079244183,"patch":[[{"diffs":[[0,"roller;\n"],[1,"var gui;\n"],[0,"\n\n// ## "]],"start1":89,"start2":89,"length1":16,"length2":25}]],"length":5195,"saved":false}
{"ts":1357079294764,"patch":[[{"diffs":[[0,"unction "],[-1,"r"],[1,"guiR"],[0,"estartGa"]],"start1":3991,"start2":3991,"length1":17,"length2":20},{"diffs":[[0,"on(){\n\t\t"],[-1,"r"],[1,"guiR"],[0,"estartGa"]],"start1":5131,"start2":5131,"length1":17,"length2":20}]],"length":5201,"saved":false}
{"ts":1357079328043,"patch":[[{"diffs":[[0," 'AI"],[-1," (easy)', 'AI (normal)', 'AI (hard)"],[0,"' ] "]],"start1":4898,"start2":4898,"length1":43,"length2":8},{"diffs":[[0," 'AI"],[-1," (easy)', 'AI (normal)', 'AI (hard)"],[0,"' ] "]],"start1":4966,"start2":4966,"length1":43,"length2":8}]],"length":5131,"saved":false}
{"ts":1357079339767,"patch":[[{"diffs":[[0," \"AI"],[-1," (normal)"],[0,"\", r"]],"start1":4679,"start2":4679,"length1":17,"length2":8}]],"length":5122,"saved":false}
{"ts":1357079423606,"patch":[[{"diffs":[[0,"1 = "],[-1,"0}\n\telse if(p1S.indexOf(\"easy\") !== -1){p1 = 1}\n\telse if(p1S.indexOf(\"normal\") !== -1)"],[1,"1}\n\telse "],[0,"{p1 = "],[-1,"2}\n\telse if(p1S.indexOf(\"hard\") !== -1){p1 = 3}\n\tif(p2S.indexOf(\"Human\") !== -1){p2 = 0}\n\telse if(p2S.indexOf(\"easy\") !== -1){p2 = 1}\n\telse if(p2S.indexOf(\"normal\") !== -1){p2 = 2}\n\telse if(p2S.indexOf(\"hard\") !== -1){p2 = 3"],[1,"0}\n\n\tif(p2S.indexOf(\"Human\") !== -1){p2 = 1}\n\telse {p2 = 0"],[0,"}\n\tw"]],"start1":4190,"start2":4190,"length1":324,"length2":81}]],"length":4879,"saved":false}
{"ts":1357079447475,"patch":[[{"diffs":[[0,"{p1 = 0}"],[1,";      // AI"],[0,"\n\n\tif(p2"]],"start1":4203,"start2":4203,"length1":16,"length2":28},{"diffs":[[0,"{p2 = 0}"],[1,";      // AI"],[0,"\n\tworld."]],"start1":4272,"start2":4272,"length1":16,"length2":28}]],"length":4903,"saved":false}
{"ts":1357079540520,"patch":[[{"diffs":[[0," AI\n"],[-1,"\tworld.reset(p1, p2"],[1,"    \n    representation.destroyWorld();\n\tcontroller.initLevel(p1, p2);\n    representation.createWorld("],[0,");\n}"]],"start1":4289,"start2":4289,"length1":27,"length2":110}]],"length":4986,"saved":false}
{"ts":1357079606997,"patch":[[{"diffs":[[0,"ar gui;\n"],[1,"var isUserInteracting = false,\n    onMouseDownMouseX = 0, onMouseDownMouseY = 0,\n\tlon = 90, onMouseDownLon = 0,\n\tlat = 22, onMouseDownLat = 0,\t\t// set lat to 40 to change the cameras position from start\n\tphi = 0, theta = 0, fov = 70.711;"],[0,"\n\n// ## "]],"start1":98,"start2":98,"length1":16,"length2":253}]],"length":5223,"saved":false}
{"ts":1357079699880,"patch":[[{"diffs":[[0,"art\n"],[-1,"\tphi = 0, theta = 0,"],[1,"   "],[0," fov"]],"start1":305,"start2":305,"length1":28,"length2":11},{"diffs":[[0,"0;\n\t}\n\n\t"],[-1,"c"],[1,"representation.getC"],[0,"amera"],[1,"()"],[0,".project"]],"start1":4074,"start2":4074,"length1":22,"length2":42}]],"length":5226,"saved":false}
{"ts":1357079755989,"patch":[[{"diffs":[[0," lat;\n\t\n"],[1,"//"],[0,"\t// Shoo"]],"start1":2689,"start2":2689,"length1":16,"length2":18},{"diffs":[[0,"s.html]\n"],[1,"//"],[0,"\tvar vec"]],"start1":2811,"start2":2811,"length1":16,"length2":18},{"diffs":[[0," 0.5 );\n"],[1,"//"],[0,"\tproject"]],"start1":2950,"start2":2950,"length1":16,"length2":18},{"diffs":[[0,", camera );\n"],[-1,"\n"],[1,"//\n//"],[0,"\tvar ray = n"]],"start1":2994,"start2":2994,"length1":25,"length2":29},{"diffs":[[0,"ze() );\n"],[-1,"\n"],[1,"//\n//"],[0,"\tvar int"]],"start1":3095,"start2":3095,"length1":17,"length2":21},{"diffs":[[0,"rr() );\n"],[-1,"\n"],[1,"//\n//"],[0,"\tif ( in"]],"start1":3169,"start2":3169,"length1":17,"length2":21},{"diffs":[[0,"> 0 ) {\n"],[1,"//"],[0,"\t\tworld."]],"start1":3206,"start2":3206,"length1":16,"length2":18},{"diffs":[[0,"index);\n"],[1,"//"],[0,"\t\t// var"]],"start1":3261,"start2":3261,"length1":16,"length2":18},{"diffs":[[0,"rial );\n"],[1,"//"],[0,"\t\t// par"]],"start1":3323,"start2":3323,"length1":16,"length2":18},{"diffs":[[0,".point;\n"],[1,"//"],[0,"\t\t// par"]],"start1":3373,"start2":3373,"length1":16,"length2":18},{"diffs":[[0,".y = 8;\n"],[1,"//"],[0,"\t\t// sce"]],"start1":3421,"start2":3421,"length1":16,"length2":18},{"diffs":[[0,"icle );\n"],[-1,"\n"],[1,"//\n//"],[0,"\t}\n}\n\nfu"]],"start1":3451,"start2":3451,"length1":17,"length2":21}]],"length":5258,"saved":false}
{"ts":1357079779353,"patch":[[{"diffs":[[0,",\n    on"],[-1,"Mouse"],[1,"Pointer"],[0,"DownMous"]],"start1":135,"start2":135,"length1":21,"length2":23},{"diffs":[[0,"useX = 0, on"],[-1,"Mouse"],[1,"Pointer"],[0,"DownMouseY ="]],"start1":156,"start2":156,"length1":29,"length2":31}]],"length":5262,"saved":false}
{"ts":1357079800461,"patch":[[{"diffs":[[0,"nterDown"],[-1,"Mouse"],[1,"Pointer"],[0,"X = 0, o"]],"start1":146,"start2":146,"length1":21,"length2":23},{"diffs":[[0,"nterDown"],[-1,"Mouse"],[1,"Pointer"],[0,"Y = 0,\n\t"]],"start1":173,"start2":173,"length1":21,"length2":23},{"diffs":[[0,"lon = 90, on"],[-1,"Mouse"],[1,"Pointer"],[0,"DownLon = 0,"]],"start1":196,"start2":196,"length1":29,"length2":31},{"diffs":[[0,"= 22, on"],[-1,"Mouse"],[1,"Pointer"],[0,"DownLat "]],"start1":233,"start2":233,"length1":21,"length2":23}]],"length":5270,"saved":false}
{"ts":1357079957860,"patch":[[{"diffs":[[0,"element\n"],[1,"    representation.setCamera(lon, lat);\n"],[0,"\treprese"]],"start1":2205,"start2":2205,"length1":16,"length2":56}]],"length":5310,"saved":false}
{"ts":1357080048188,"patch":[[{"diffs":[[0,"ar gui;\n"],[1,"var stats;\n"],[0,"var isUs"]],"start1":98,"start2":98,"length1":16,"length2":27}]],"length":5321,"saved":false}
{"ts":1357080049217,"patch":[[{"diffs":[[0," stats;\n"],[1,"\n"],[0,"var isUs"]],"start1":109,"start2":109,"length1":16,"length2":17}]],"length":5322,"saved":false}
{"ts":1357080088987,"patch":[[{"diffs":[[0,"    "],[-1,"representation.GUIrestart"],[1,"guiRestartGame"],[0,"(tru"]],"start1":1858,"start2":1858,"length1":33,"length2":22}]],"length":5311,"saved":false}
{"ts":1357080384983,"patch":[[{"diffs":[[0,"ayer2AI)"],[1,";"],[0,"\n\t});\n}\n"]],"start1":5291,"start2":5291,"length1":16,"length2":17}]],"length":5312,"saved":false}
{"ts":1357080393314,"patch":[[{"diffs":[[0,"lse {p1 = 0}"],[-1,";"],[0,"      // AI\n"]],"start1":4524,"start2":4524,"length1":25,"length2":24},{"diffs":[[0,"{p2 = 0}"],[-1,"; "],[0,"     // "]],"start1":4596,"start2":4596,"length1":18,"length2":16}]],"length":5309,"saved":false}
{"ts":1357080398620,"patch":[[{"diffs":[[0,"else {p1 = 0"],[1,";"],[0,"}      // AI"]],"start1":4523,"start2":4523,"length1":24,"length2":25},{"diffs":[[0," {p2 = 0"],[1,";"],[0,"}     //"]],"start1":4596,"start2":4596,"length1":16,"length2":17}]],"length":5311,"saved":false}
{"ts":1357080653437,"patch":[[{"diffs":[[0,") {\n"],[-1,"return;\n"],[0,"\tgui"]],"start1":4745,"start2":4745,"length1":16,"length2":8}]],"length":5303,"saved":false}
{"ts":1357080763322,"patch":[[{"diffs":[[0,"ame("],[-1,"true, false"],[1,"\"Human\", \"AI\""],[0,");\n}"]],"start1":1873,"start2":1873,"length1":19,"length2":21}]],"length":5305,"saved":false}
